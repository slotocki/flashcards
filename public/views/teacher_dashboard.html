<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel nauczyciela - MemoRise</title>
    <link href="/public/styles/main.css" rel="stylesheet">
</head>
<body>
    <nav>
        <div class="nav-brand">
            <a href="/dashboard"><img src="/public/images/logo.png" alt="MemoRise Logo" class="logo"></a>
        </div>
        <ul>
            <li><a href="/dashboard" class="active">Strona g贸wna</a></li>
            <li><a href="/teacher">Twoje klasy</a></li>
            <li><a href="/account">Twoje konto</a></li>
            <li><a href="#" onclick="logout(); return false;">Wyloguj</a></li>
        </ul>
    </nav>

    <div class="container">
        <main>
            <section class="teacher-welcome">
                <h1>Panel nauczyciela</h1>
                <p>Witaj! Zarzdzaj swoimi zestawami fiszek i klasami.</p>
            </section>
            
            <!-- MOJE ZESTAWY - niezale偶ne od klas -->
            <section class="teacher-panel">
                <div class="section-header">
                    <h2>Moje zestawy fiszek</h2>
                    <button class="btn-primary" onclick="showCreateDeckModal()">+ Utw贸rz zestaw</button>
                </div>
                
                <div id="teacherDecks" class="decks-grid">
                    <p class="loading">adowanie zestaw贸w...</p>
                </div>
            </section>
            
            <!-- MOJE KLASY -->
            <section class="teacher-panel">
                <div class="section-header">
                    <h2>Moje klasy</h2>
                    <button class="btn-primary" onclick="showCreateClassModal()">+ Utw贸rz klas</button>
                </div>
                
                <div class="teacher-classes-list" id="teacherClasses">
                    <p class="loading">adowanie klas...</p>
                </div>
            </section>

            <!-- Szczeg贸y wybranej klasy -->
            <section class="selected-class-section" id="selectedClassSection" style="display: none;">
                <div class="section-header">
                    <h2 id="selectedClassName">Wybrana klasa</h2>
                    <div class="class-actions">
                        <span class="join-code" id="classJoinCode">Kod: </span>
                        <button class="btn-secondary btn-sm" onclick="showAssignDecksModal()">Przypisz zestawy</button>
                        <button class="btn-danger btn-sm" onclick="deleteSelectedClass()">Usu klas</button>
                    </div>
                </div>
                
                <div class="tabs">
                    <button class="tab active" data-tab="classDecks">Przypisane zestawy</button>
                    <button class="tab" data-tab="tasks">Zadania</button>
                    <button class="tab" data-tab="members">Uczniowie</button>
                </div>
                
                <div class="tab-content" id="classDecksTab">
                    <div id="decksList" class="decks-list"></div>
                </div>
                
                <div class="tab-content" id="tasksTab" style="display: none;">
                    <div class="section-header">
                        <h3>Zadania</h3>
                        <button class="btn-primary btn-sm" onclick="showCreateTaskModal()">+ Dodaj zadanie</button>
                    </div>
                    <div id="tasksList" class="tasks-list"></div>
                </div>
                
                <div class="tab-content" id="membersTab" style="display: none;">
                    <h3>Uczniowie w klasie</h3>
                    <div id="membersList" class="members-list"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal tworzenia klasy -->
    <div id="createClassModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Utw贸rz now klas</h2>
                <button class="close-btn" onclick="closeModal('createClassModal')">&times;</button>
            </div>
            <form id="createClassForm">
                <div class="input-group">
                    <label for="className">Nazwa klasy</label>
                    <input type="text" id="className" name="name" required maxlength="200">
                </div>
                <div class="input-group">
                    <label for="classDescription">Opis (opcjonalnie)</label>
                    <textarea id="classDescription" name="description" rows="3"></textarea>
                </div>
                <div class="input-group">
                    <label for="classLanguage">Jzyk</label>
                    <select id="classLanguage" name="language">
                        <option value="">-- Wybierz --</option>
                        <option value="de">Niemiecki </option>
                        <option value="en">Angielski </option>
                        <option value="es">Hiszpaski </option>
                        <option value="fr">Francuski </option>
                        <option value="it">Woski </option>
                        <option value="ru">Rosyjski 佛</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('createClassModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Utw贸rz</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal tworzenia decku -->
    <div id="createDeckModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj nowy zestaw</h2>
                <button class="close-btn" onclick="closeModal('createDeckModal')">&times;</button>
            </div>
            <form id="createDeckForm" enctype="multipart/form-data">
                <div class="input-group">
                    <label for="deckTitle">Tytu zestawu</label>
                    <input type="text" id="deckTitle" name="title" required maxlength="200">
                </div>
                <div class="input-group">
                    <label for="deckDescription">Opis (opcjonalnie)</label>
                    <textarea id="deckDescription" name="description" rows="3"></textarea>
                </div>
                <div class="input-group">
                    <label for="deckLevel">Poziom</label>
                    <select id="deckLevel" name="level">
                        <option value="beginner">Pocztkujcy</option>
                        <option value="intermediate">redniozaawansowany</option>
                        <option value="advanced">Zaawansowany</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="deckImage">Zdjcie pogldowe (okadka zestawu)</label>
                    <input type="file" id="deckImage" name="deckImage" accept="image/jpeg,image/png,image/gif,image/webp">
                    <small class="input-hint">Akceptowane formaty: JPG, PNG, GIF, WEBP (max 2MB)</small>
                    <div id="deckImagePreview" class="image-preview" style="display: none; margin-top: 0.5rem;">
                        <img id="deckPreviewImg" src="" alt="Podgld" style="max-width: 200px; max-height: 150px; border-radius: 8px;">
                        <button type="button" class="btn-sm btn-secondary" onclick="clearDeckImagePreview()" style="margin-left: 0.5rem;">Usu</button>
                    </div>
                </div>
                <div class="input-group">
                    <label>Przypisz do klas (opcjonalnie)</label>
                    <div id="deckClassSelection" class="class-selection">
                        <p class="text-muted">adowanie klas...</p>
                    </div>
                    <small class="input-hint">Mo偶esz przypisa zestaw do wybranych klas lub udostpni go tylko spoecznoci.</small>
                </div>
                <div class="input-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="deckIsPublic" name="isPublic">
                        Udostpnij spoecznoci
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('createDeckModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal przypisywania zestawu do klas -->
    <div id="assignClassesModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Przypisz zestaw do klas</h2>
                <button class="close-btn" onclick="closeModal('assignClassesModal')">&times;</button>
            </div>
            <form id="assignClassesForm">
                <input type="hidden" id="assignDeckId" name="deckId">
                <div class="input-group">
                    <label>Wybierz klasy:</label>
                    <div id="assignClassSelection" class="class-selection">
                        <p class="text-muted">adowanie klas...</p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('assignClassesModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Zapisz</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal dodawania fiszki -->
    <div id="createCardModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj fiszk</h2>
                <button class="close-btn" onclick="closeModal('createCardModal')">&times;</button>
            </div>
            <form id="createCardForm">
                <div class="input-group">
                    <label for="cardFront">Prz贸d (pytanie/sowo)</label>
                    <textarea id="cardFront" name="front" required rows="2"></textarea>
                </div>
                <div class="input-group">
                    <label for="cardBack">Ty (odpowied藕/tumaczenie)</label>
                    <textarea id="cardBack" name="back" required rows="2"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('createCardModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal tworzenia zadania -->
    <div id="createTaskModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj zadanie</h2>
                <button class="close-btn" onclick="closeModal('createTaskModal')">&times;</button>
            </div>
            <form id="createTaskForm">
                <div class="input-group">
                    <label for="taskTitle">Tytu zadania</label>
                    <input type="text" id="taskTitle" name="title" required maxlength="200">
                </div>
                <div class="input-group">
                    <label for="taskDescription">Opis (opcjonalnie)</label>
                    <textarea id="taskDescription" name="description" rows="3"></textarea>
                </div>
                <div class="input-group">
                    <label for="taskDeck">Zestaw fiszek</label>
                    <select id="taskDeck" name="deckId" required>
                        <option value="">-- Wybierz zestaw --</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="taskDueDate">Termin</label>
                    <input type="datetime-local" id="taskDueDate" name="dueDate">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('createTaskModal')">Anuluj</button>
                    <button type="submit" class="btn-primary">Dodaj</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/public/scripts/api.js"></script>
    <script src="/public/scripts/main.js"></script>
    <script src="/public/scripts/auth.js"></script>
    <script src="/public/scripts/teacher.js"></script>
</body>
</html>